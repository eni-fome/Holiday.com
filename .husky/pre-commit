#!/bin/sh

# Check for .env files
if git diff --cached --name-only | grep -E "\.env$"; then
  echo "❌ Error: Attempting to commit .env file!"
  echo "Please remove .env from staging area:"
  echo "  git reset HEAD .env"
  exit 1
fi

# Check for potential secrets in staged files
if git diff --cached | grep -iE "(api_key|api_secret|password|secret_key|private_key|token).*=.*['\"]?[a-zA-Z0-9]{20,}"; then
  echo "⚠️  Warning: Potential secrets detected in staged files!"
  echo "Please review your changes carefully."
  read -p "Continue with commit? (y/N) " -n 1 -r
  echo
  if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    exit 1
  fi
fi
